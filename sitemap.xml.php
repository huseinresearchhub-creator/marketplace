<?php require_once __DIR__.'/includes/config.php'; header('Content-Type: application/xml; charset=utf-8'); $base = 'http://localhost/marketplace'; // ganti saat live (https://domain.com) $urls = [ ['loc'=>$base.'/', 'priority'=>'1.0'], ['loc'=>$base.'/faq', 'priority'=>'0.6'], ]; try { // tambahkan kolom updated_at jika belum ada (opsional, aman diabaikan jika sudah) $pdo->exec("ALTER TABLE produk ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"); } catch (Throwable $e) { /* ignore for compatibility */ } $stmt = $pdo->query("SELECT slug, updated_at FROM produk ORDER BY id DESC"); $rows = $stmt ? $stmt->fetchAll(PDO::FETCH_ASSOC) : []; echo '<?xml version="1.0" encoding="UTF-8"?>';
?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">

<?php foreach ($urls as $u): ?> <url> <loc><?= htmlspecialchars($u['loc']) ?></loc> <priority><?= $u['priority'] ?></priority> </url> <?php endforeach; ?> <?php foreach ($rows as $r): ?> <url> <loc><?= htmlspecialchars($base.'/product/'.$r['slug']) ?></loc> <?php if (!empty($r['updated_at'])): ?><lastmod><?= date('c', strtotime($r['updated_at'])) ?></lastmod><?php endif; ?> <priority>0.8</priority> </url> <?php endforeach; ?> </urlset>